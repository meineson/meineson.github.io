<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="author" content="MEINESON,meineson@gmail.com"><title>4G（LTE）背后的技术和利益纠结——VoIP，VoLTE，SIP，IMS的前世今生 · MBSTUDIO</title><meta name="description" content="不管国内的3G的发展是多么的怪异，中国移动是多么的苦逼地半推半就发展着TD-SCDMA这个“国产”的3G，也不管你究竟有没有反应过来，4G是又快要来了，但即使4G经过了这么多年，被通讯界的大佬们（3GPP，3GPP2，OMA，GSMA等等）反复讨论了n多遍，发了多少版Release标准化文档，一众业"><meta name="keywords" content="mbstudio,ICT,RCS,Deep Learning,Digital Twin,AIGC"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="renderer" content="webkit"><link rel="short icon" href="/images/favicon.png" type="image/x-icon"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/blog_basic.css"><link rel="stylesheet" href="/css/font-awesome.min.css"><link rel="alternate" type="application/atom+xml" title="ATOM 1.0" href="/atom.xml"><meta name="generator" content="Hexo 7.3.0"></head><body><div class="sidebar animated fadeInDown"><div class="logo-title"><div class="title"><img src="/images/logo@2x.png" style="width:127px;"><h3 title=""><a href="/">MBSTUDIO</a></h3><div class="description"><p>魔瓶工作室 since 2001 /RCS OS IOT AI DigitalTwin/</p></div></div></div><ul class="social-links"><li><a href="mailto:meineson@gmail.com"><i class="fa fa-envelope">         </i></a></li><li><a target="_blank" rel="noopener" href="https://weibo.com/meineson"><i class="fa fa-weibo"></i></a></li><li><a target="_blank" rel="noopener" href="http://github.com/meineson"><i class="fa fa-github"></i></a></li></ul><div class="footer"></div></div><div class="main"><div class="page-top animated fadeInDown"><div class="nav"><li><a href="/">首页</a></li><li><a href="/about">关于</a></li><li><a href="/archives">归档</a></li><li><a href="/links">友链</a></li></div><div class="information"><div class="back_btn"><li><a class="fa fa-chevron-left" onclick="window.history.go(-1)"> </a></li></div><div class="avatar"><img src="/images/me.png"></div></div></div><div class="autopagerize_page_element"><div class="content"><div class="post-page"><div class="post animated fadeInDown"><div class="post-title"><h3><a>4G（LTE）背后的技术和利益纠结——VoIP，VoLTE，SIP，IMS的前世今生</a></h3></div><div class="post-content"><p>不管国内的3G的发展是多么的怪异，中国移动是多么的苦逼地半推半就发展着TD-SCDMA这个“国产”的3G，也不管你究竟有没有反应过来，4G是又快要来了，但即使4G经过了这么多年，被通讯界的大佬们（3GPP，3GPP2，OMA，GSMA等等）反复讨论了n多遍，发了多少版Release标准化文档，一众业内人士还是一头雾水不知所措，更不要说普通用户了，完全是一滩浆糊……</p>
<blockquote>
<p>by meineson，<a target="_blank" rel="noopener" href="http://mbstudio.cn/">http://mbstudio.cn</a> 2013.3</p>
</blockquote>
<p>一切要重头说起，从电话技术发明，到大哥大（1G移动通讯）诞生，发展到2G数字移动通讯（GSM、CDMA），以及现在的3G（WCDMA、TD-SCDMA、CDMA-2000），4G（TD-LTE、FDD-LTE），本质上是追求成本的降低，产品功能的多样化；<br>1G很简单，就是为了让固定电话能随身携带，没有额外功能，纯粹的模拟电话信号通过无线电传输；<br>2G，以及后面的2.5G, 2.75G，是把模拟的电话信号转换成了数字化的编码，简单些理解就是家里无绳电话的模拟无线和2.4G数字无绳的区别，然后附带着，就象在电话线上提供猫拨号上网一样，提供了GPRS、EDGE的上线功能，当然，和猫上网一样，速度慢是典型的特点，这一时期还提供了象短信、彩信等一些有限的增值服务；<br>3G的重点放在了上网速度上，语音电话弱化了，但其本质是在2G上发展而来的，大量的科学家的精力花在了如何在旧体系上，有没有办法多压榨些资源来传输上网数据——这有点象把一个书架上的放书的格子和位置好好规范了一下，比随便乱放能放更多书了，但根本问题没解决，有限的通讯资源要保留着随时准备让语音电话使用，所以成本还是居高不下；<br>4G其实对普通用户意义不大，真正商用能稳定提供的下行带宽也就10M左右，与联通WCDMA宣传的3G的速度差别不大，虽然4G理论上能提供的速度能达到100M，但理论就只是理论，而已。<br>之前有过一篇文章说到过，4G之所以在用户需求层面没有动力时，运营商仍要大力去推，这好象有些不符合商业规律——技术本应该是根据市场用户需求而诞生的，但根源，是因为4G改变了从2G到3G时的运营商网络的建设方式和运营成本，4G不再保留无线通讯资源来专门跑语音了，而是所有资源全部用来跑数据——就是全部用来上网；</p>
<p>打电话时，走2G、3G线路上的语音保留资源，这是“独占”的资源，而4G所有的资源，都用来跑数据，电话语音也变成数据，大家可以“共享”网络带宽速率，显而易见，共享的资源的成本，肯定要大大低于独占的资源了，所以4G的数据资费，成本会远远低于3G时的上网成本，当然，这是对于运营商有利的，最终定什么价，还是运营商定；</p>
<p>虽然我们这里主要是说4G——也就是手机、移动通讯，但固定电话和固定宽带，技术上也是有相似性的，和上面移动通讯要发展1G、2G、3G、4G一样，固定电话和固定宽带也在从电话线——电话线+拨号上网——电话线+ADSL上网——纯光纤上网（送终端设备，从光纤上面接电话出来），几乎是和移动通讯类似的发展轨迹；</p>
<p>不管是4G的最终发展目标，还是光纤上网整合宽带上网和固定电话，他们都有一个统称，NGN下一代网络，美好的规范图是这样描绘的——在一个网络（NGN）上，同时能提供上网、电话、电视以及各种增值服务，三网融合；</p>
<p>手机移动通讯要实现这些美好愿景，在可以预见的未来，不太容易实现，特别是第一阶段，能让大家用习惯了的电话，顺顺当当跑在4G网络上，就是一项艰巨的任务，所以，3G会在相当长的时间里，和4G是共存的，并且4G更长一段时间，可能只是用来提供数据服务，这是因为——VoLTE还不成熟；<br>目前市面上的4G手机，都只是用4G来上网，而打电话仍走原来的3G或2G的通道，因为4G要想独立打电话，需要有IMS服务器和IMS软件终端，但无论是IMS服务器的成熟度和软件的终端的成熟度，还不够成熟，所以中国移动要采购的第一批产品中的MIFI和CPE，MIFI称为能提供4G接入的无线路由器的理解没错，而对CPE的名词解释，很多家专业媒体都说错了，CPE是在MIFI基础上，还留有一个模拟电话的接口，接上电话机就能打电话，而电话就是走的IMS服务器，真正的VoLTE，这算是移动用来试水的举措吧，用来测试IMS服务器的，稳定了才在手机上跑VoLTE；</p>
<p>上面我们提到多个通讯行业的国际标准化组织，他们这么多年做的大量工作，就是为了让4G这个纯IP网络化的移动通讯网络，能让语音在共享的数据网络上（PS，即包交换），能象从前在独占的语音网络上（CS，即电路交换）跑的一样遛，他们想到了VoIP；</p>
<p>VoIP里面有许多标准，Skype是私有的，H323是通讯行业的标准，SIP是IETF也就是互联网组织定的，为什么通讯行业定未来下一个几十年的标准时，不是从他们自己的H323上面发展，而是选互联网行业标准组织IETF提出的SIP标准呢？大家都笑而不语……</p>
<p>但互联网的原则是开放，还有一个就是免费，所以SIP在脱离于通讯行业标准约束时，非常自由，对于不同供应商提供的SIP服务之间的结算啊、费用啊之类的没有通讯行业那么细——说白了，就是SIP提供的许多服务都是免费的，要想收费不太好下手，由此，3GPP等等一众通讯行业的标准化组织，在SIP基础上，提出了IMS，到此，我们标题里说的SIP、VoIP、VoLTE、IMS这些名词全部出场了。</p>
<p>VoIP解释起来简单，就是Voice on IP，语音跑在IP网络上，就是VoIP，这是一个比较上层的统称的名词，那么同样的VoLTE也只是说语音跑在LTE网络上——LTE就是指的4G的两个标准，TD-LTE、FDD-LTE——需要注意的是，TD-LTE和TD-SCDMA没有任何关系，其它的我就不多说了。</p>
<p>LTE全称是Long Time Evolution，从名字上就知道，4G这个东西提出的很匆忙，许多东西还没定好就被运营商急着要上线。</p>
<p>而IMS这个东西就要复杂的多了，虽然SIP很好理解，大家暗地里可能也用了好多年的VoIP，对SIP也很熟悉了，它本质上就是一个服务器，放账号，大家注册上去就能打电话，很简单吧，但要收费呢，目前VoIP一般也只提供了便宜的网络电话，按时长或者包月收费，没有增值服务——这对于移动通讯运营商来说可是不能忍受的。<br>来电显示为什么不能收费？为什么彩铃不能收费？为什么留言不能收费？为什么为什么？…………</p>
<p>所以，IMS干的第一件是，就是加入了一个HSS子服务（Home Subscriber Server），这个是什么东西呢？SIP虽然也分为注册服务器Register Server、呼叫代理服务器Proxy Server，但SIP的注册服务器只是记录一下一个SIP账号的当前的IP地址数据、认证一下账号密码是不是正确；但IMS里的HSS就不简单了，他是在SIP的注册服务器基础上，增加了一个很明显的运营商特征——业务订购数据库，也就是在移动开手机卡时，那一堆附加增值服务，好了，你在这里可以看到来电显示业务、呼叫等待业务、彩铃业务……，的开关——也意味着收费的计费点；</p>
<p>因为VoIP很简单，一般是企业内部用，或者小规模的虚拟运营商在有限的几台服务器上提供服务，所以VoIP的SIP软件、SIP电话机网关就可以直接通过IP地址和账号就能注册上去，然后呼叫在多台服务器上互相路由就可以完成呼叫的目的了，这些服务器，一般就是SIP Proxy Server，涉及到和固定电话、手机号码互通时，会有FXO网关，E1网关等负责转换，这里不多说了；</p>
<p>而IMS作为运营商的方案，动辄上亿用户规模，而且又分为各省市地分公司，当然，还有一个不得不提的，漫游——IP还区分漫游？VoIP不是宣传不区分本地长途，没有漫游的概念么？是的，但IMS认为这样不行，所以，他要加入漫游的概念……</p>
<p>IMS的核心是SIP，所以类似SIP Proxy Server这么重要的核心组件，IMS是不会少的，IMS里称它为Call Session Control Function，即CSCF，并且又把它分成了多个子系统，其中代理CSCF（P-CSCF）从用户终端角度看，基本就是SIP里的Proxy Server了（但其实不是，下述），负责直接与IMS的终端（类似SIP的软电话、硬件电话等等，但同样的，也扩展了不少东西，这里跳过不述）；P-CSCF直接与终端交互，可能会把SIP进行压缩或者加密，然后就交给查询CSCF（I-CSCF），I-CSCF会查询HSS数据，来对用户名和密码进行认证，当然，他也从HSS里查询你是否欠费了，开通或关闭了某些业务，以及你是从哪个P-CSCF来的，用来判断你是不是漫游；</p>
<p>整个呼叫过程中，P-CSCF是不做复杂工作的，P-CSCF只负责接收SIP消息，它相当于是对外联络点，然后SIP消息会到达I-CSCF，I-CSCF是运营商的核心网络——就是运营商内部网络的入口，他会根据HSS查找到用户是属于哪个地区的，会对应分配一个空闲的为该地区服务的服务CSCF（S-CSCF），一直到了这里，S-CSCF才是真正的VoIP里Proxy Server的角色，S-CSCF完成用户注册认证和呼叫的路由处理，以及电话业务的触发（IMS称为AS，另外独立成一个子系统，下述）；</p>
<p>所以如果综合来分析，P-CSCF和I-CSCF只是起到一个边界安全防护SBC服务器和负载平衡、服务器分流这一类功能，真正处理SIP注册和呼叫的原先VoIP里标准逻辑的组件，是S-CSCF，从物理上看，P-CSCF可能是全国或省一级中心统一的服务器集群，配合更多的I-CSCF服务器分布在主干核心网上做分流，背靠一个大的HSS服务器群，将不同市县的用户分配到各地的S-CSCF上进行实际的处理，并且S-CSCF会更多地与当地的通讯机房里原有的2G、3G发生交流，也就是媒体网关（MGW），负责把新的走4G的手机终端和旧的3G、2G以及固定电话之类的对接起来，保持兼容（也就是PS、CS域的互通）；</p>
<p>所以，一个最最精简的IMS系统，它的核心组件是包含HSS、CSCF（P、I、S）即可，即把VoIP SIP的核心Register和Proxy Server进行按运营需求的发展：<br>4G（LTE）背后的技术和利益纠结——VoIP，VoLTE，SIP，IMS的前世今生</p>
<p>而MGW，其实就是市面上大量被使用的VoIP的模拟网关，数字中继网关，而已……当然，运营商对稳定性要求需要更高一些，并且需要额外的集中管理和控制能力；</p>
<p>但如果上了4G也只是为了提供和原来类似的语音通话功能，运营商的面子还是挂不住的，得与时俱进，提供一些IM服务，面向个人用户，所以一般还要加一个Presence Server，推送服务器，离线存储服务器等云的概念，提供的，无非是类似qq或微信的功能了，当然，可能是收费的，再次笑而不语……<br>同样的，通讯不只是面向个人的，也要面向企业，所以上面也提到了AS子系统，即Application Server，其实就是现在的通讯行业内的增值方案服务供应商了，一般就是提供例如电话会议、语音留言，企业语音导航IVR，电话呼入自动分配ACD等等；</p>
<p>因为象4G或者NGN，大家全是跑在IP网络上的，所以就不再需要象原先做电话呼叫中心，CTI系统等等，让电话与电脑信息系统对接需要额外购买一台电话程控交换机、语音板卡等等才能使用的问题了，只要有能接入网络的智能的设备，电脑、手机、平板，都可以直接与IMS的AS子系统对接，这可能才是真正的推4G或ngn的价值吧，让电话也完全融入电脑的IP网络世界里，电话、手机独立在企业的信息化系统外面已经太多年了，如果这一均势发展良好，那些老掉牙的定制的CTI通讯系统，终于可以跟上互联网产品发展的节奏，让我们接触的象银行、快递公司的电话系统，医院的挂号、火车飞车的买票的电话系统，真正的能跟上时代发展的脚步了，IVR语音菜单导航这种逆天反人类的存在，早就该被淘汰了！</p>
</div><div class="post-footer"><div class="meta"><div class="info"><i class="fa fa-sun-o"></i><span class="date">2013-03-27</span><i class="fa fa-tag"></i></div></div></div></div><div class="share"><div class="evernote"><a class="fa fa-bookmark" href="javascript:(function(){EN_CLIP_HOST='http://www.evernote.com';try{var%20x=document.createElement('SCRIPT');x.type='text/javascript';x.src=EN_CLIP_HOST+'/public/bookmarkClipper.js?'+(new%20Date().getTime()/100000);document.getElementsByTagName('head')[0].appendChild(x);}catch(e){location.href=EN_CLIP_HOST+'/clip.action?url='+encodeURIComponent(location.href)+'&amp;title='+encodeURIComponent(document.title);}})();" ref="nofollow" target="_blank"></a></div><div class="weibo"><a class="fa fa-weibo" href="javascript:void((function(s,d,e){try{}catch(e){}var f='http://service.weibo.com/share/share.php?',u=d.location.href,p=['url=',e(u),'&amp;title=',e(d.title),'&amp;appkey=2924220432'].join('');function a(){if(!window.open([f,p].join(''),'mb',['toolbar=0,status=0,resizable=1,width=620,height=450,left=',(s.width-620)/2,',top=',(s.height-450)/2].join('')))u.href=[f,p].join('');};if(/Firefox/.test(navigator.userAgent)){setTimeout(a,0)}else{a()}})(screen,document,encodeURIComponent));"></a></div><div class="twitter"><a class="fa fa-twitter" target="_blank" rel="noopener" href="http://twitter.com/home?status=,https://meineson.github.io/2013/03/27/4g/,MBSTUDIO,4G（LTE）背后的技术和利益纠结——VoIP，VoLTE，SIP，IMS的前世今生,;"></a></div></div><div class="pagination"><ul class="clearfix"><li class="pre pagbuttons"><a class="btn" role="navigation" href="/2013/10/15/smartwatch/" title="对智能可穿戴设备的一些吐槽和产品概念分析（智能手表、智能手环）">上一篇</a></li><li class="next pagbuttons"><a class="btn" role="navigation" href="/2013/03/01/voip/" title="VoIP/SIP在无线WIFI网络下通话时无缝切换,及无线路由设备常见的几种工作模式解释">下一篇</a></li></ul></div></div></div></div></div><script src="/js/jquery.js"></script><script src="/js/jquery-migrate-1.2.1.min.js"></script><script src="/js/jquery.appear.js"></script><script src="/js/baidu.js"> </script></body></html>